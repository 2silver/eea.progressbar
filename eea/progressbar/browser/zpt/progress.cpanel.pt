<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="eea">

<metal:top fill-slot="top_slot">
  <link rel="stylesheet" tal:attributes="href string:$portal_url/++resource++eea.progressbar.controlpanel.css" />
  <script tal:attributes="src string:$portal_url/++resource++eea.progressbar.controlpanel.js"
    type="text/javascript"></script>
</metal:top>


<body>
<div id="content" metal:fill-slot="prefs_configlet_main">
  <div id="eea-progressbar-cpanel">
    <tal:field tal:repeat="field view/schema">
      <fieldset tal:define="name field/getName"
        tal:attributes="id string:progress-schema-$name" class="eea-progressbar-widget">
        <legend tal:content="name">Field label</legend>
        <div class="preview" tal:define="viewform python:view.view(field)">
          <tal:view
            replace="structure python:viewform(ready=False)">Widget body</tal:view>
          <tal:view
            replace="structure python:viewform(ready=True)">Widget body</tal:view>
          <div class="workflow" title="Workflow states" i18n:attributes="title">
            <span tal:content="python:', '.join(term.title for term in viewform.workflow())">Workflow states</span>
          </div>
        </div>
        <form method="post" tal:define="
          editform python:view.edit(field);
          name python:editform.__name__;"
          tal:attributes="action string:${context/absolute_url}/.schema/@@$name">
          <tal:edit replace="structure editform">Widget body</tal:edit>
        </form>
      </fieldset>
    </tal:field>
  </div>
</div>
</body>
</html>
